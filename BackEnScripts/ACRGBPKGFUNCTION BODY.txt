create or replace PACKAGE BODY          "ACRGBPKGFUNCTION" AS
 
  -------------------------------------------------------------------------
  --  ASSETS TABLE
  FUNCTION ACR_ASSETS(tags IN VARCHAR,
  phcfid IN ACR_ASSETS_TBL.HCFID%TYPE) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN

  IF(tags='ACTIVE') THEN
      IF(phcfid=0) THEN
          OPEN v_result FOR 
          SELECT  RELEASEDAMOUNT,PREVIOUSBAL,ASSETSID,HCFID,TRANCHID,RECEIPT,AMOUNT,CREATEDBY,DATERELEASED,DATECREATED,CONID,STATS
          FROM DRG_SHADOWBILLING.ACR_ASSETS_TBL WHERE STATS='2' ORDER BY DATERELEASED ASC;
       ELSE
          OPEN v_result FOR 
          SELECT   RELEASEDAMOUNT,PREVIOUSBAL,ASSETSID,HCFID,TRANCHID,RECEIPT,AMOUNT,CREATEDBY,DATERELEASED,DATECREATED,CONID,STATS
          FROM DRG_SHADOWBILLING.ACR_ASSETS_TBL WHERE CONID=phcfid AND STATS='2' ORDER BY DATERELEASED ASC;
       END IF;
  ELSE
      OPEN v_result FOR 
      SELECT  RELEASEDAMOUNT,PREVIOUSBAL,ASSETSID,HCFID,TRANCHID,RECEIPT,AMOUNT,CREATEDBY,DATERELEASED,DATECREATED,CONID,STATS
      FROM DRG_SHADOWBILLING.ACR_ASSETS_TBL WHERE STATS='3' ORDER BY DATERELEASED ASC;
  END IF;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
   -- RETURN ACR_ASSETS;
  END ACR_ASSETS;
  --END  ASSETS TABLE
  -------------------------------------------------------------------------
  --  CONTRACT TABLE
  FUNCTION ACR_CONTRACT(tags IN VARCHAR,pfchid IN ACR_CONTRACT_TBL.HCFID%TYPE) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
IF(tags='ACTIVE') THEN
      IF(pfchid=0) THEN
          OPEN v_result FOR 
          SELECT QUARTER,SB,ADDAMOUNT,C_CLAIMSVOL,T_CLAIMSVOL,CONID,HCFID,AMOUNT,STATS,CREATEDBY,DATECREATED,CONTRACTDATE,TRANSCODE, BASEAMOUNT
          FROM DRG_SHADOWBILLING.ACR_CONTRACT_TBL WHERE  STATS='2';
      ELSE
          OPEN v_result FOR 
          SELECT  QUARTER,SB,ADDAMOUNT,C_CLAIMSVOL,T_CLAIMSVOL,CONID,HCFID,AMOUNT,STATS,CREATEDBY,DATECREATED,CONTRACTDATE,TRANSCODE, BASEAMOUNT
          FROM DRG_SHADOWBILLING.ACR_CONTRACT_TBL WHERE HCFID=pfchid AND STATS='2';
      END IF;
  ELSE
       IF(pfchid=0) THEN
          OPEN v_result FOR 
          SELECT  QUARTER,SB,ADDAMOUNT,C_CLAIMSVOL,T_CLAIMSVOL,CONID,HCFID,AMOUNT,STATS,CREATEDBY,DATECREATED,CONTRACTDATE,TRANSCODE, BASEAMOUNT
          FROM DRG_SHADOWBILLING.ACR_CONTRACT_TBL WHERE  STATS='3';
      ELSE
          OPEN v_result FOR 
          SELECT  QUARTER,SB,ADDAMOUNT,C_CLAIMSVOL,T_CLAIMSVOL,CONID,HCFID,AMOUNT,STATS,CREATEDBY,DATECREATED,CONTRACTDATE,TRANSCODE, BASEAMOUNT
          FROM DRG_SHADOWBILLING.ACR_CONTRACT_TBL WHERE HCFID=pfchid AND STATS='3';
      END IF;
  END IF;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
    --RETURN ACR_CONTRACT;
  END ACR_CONTRACT;
  --END  CONTRACT TABLE
  -------------------------------------------------------------------------

  -- HEALTH CARE FACILITY TABLE

  --END HEALTH CARE FACILITY TABLE
  -------------------------------------------------------------------------
  -- TRANCH TABLE
  FUNCTION ACR_TRANCH(tags IN VARCHAR) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
  IF(tags='ACTIVE') THEN
      OPEN v_result FOR 
      SELECT  TRANCHID,TRANCHTYPE,PERCENTAGE,CREATEDBY,STATS,DATECREATED
      FROM DRG_SHADOWBILLING.ACR_TRANCH_TBL WHERE STATS='2';
  ELSE
       OPEN v_result FOR 
      SELECT  TRANCHID,TRANCHTYPE,PERCENTAGE,CREATEDBY,STATS,DATECREATED
      FROM DRG_SHADOWBILLING.ACR_TRANCH_TBL WHERE STATS='3';
  END IF;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
   -- RETURN ACR_TRANCH;
  END ACR_TRANCH;
  --END TRANCH TABLE
  -------------------------------------------------------------------------
   -- TRANCH TABLE
  FUNCTION ACR_TRANCHWITHID(ptranchid IN ACR_TRANCH_TBL.TRANCHID%TYPE) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
      OPEN v_result FOR 
      SELECT  TRANCHID,TRANCHTYPE,PERCENTAGE,CREATEDBY,STATS,DATECREATED
      FROM DRG_SHADOWBILLING.ACR_TRANCH_TBL WHERE TRANCHID=ptranchid AND STATS='2';

  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
   -- RETURN ACR_TRANCH;
  END ACR_TRANCHWITHID;
  --END TRANCH TABLE
  -------------------------------------------------------------------------
   -- USER DETAILS TABLE
  FUNCTION ACR_USER_DETAILS(tags IN VARCHAR) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
  IF(tags='ACTIVE') THEN
      OPEN v_result FOR 
      SELECT  DID,FIRSTNAME,LASTNAME,MIDDLENAME,DATECREATED,CREATEDBY,STATS,EMAIL,CONTACT
      FROM DRG_SHADOWBILLING.ACR_USER_DETAILS_TBL WHERE STATS='2';
  ELSE
      OPEN v_result FOR 
      SELECT  DID,FIRSTNAME,LASTNAME,MIDDLENAME,DATECREATED,CREATEDBY,STATS,EMAIL,CONTACT
      FROM DRG_SHADOWBILLING.ACR_USER_DETAILS_TBL WHERE STATS='3';
  END IF;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
    --RETURN ACR_USER_DETAILS;
  END ACR_USER_DETAILS;
  --END USER DETAILS TABLE
  -------------------------------------------------------------------------
   -- USER LEVEL TABLE
  FUNCTION ACR_USER_LEVEL(tags IN VARCHAR) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
  IF(tags='ACTIVE') THEN
      OPEN v_result FOR 
      SELECT  LEVELID,LEVDETAILS,LEVNAME,CREATEDBY,DATECREATED,STATS
      FROM DRG_SHADOWBILLING.ACR_USER_LEVEL_TBL WHERE STATS='2';
  ELSE
      OPEN v_result FOR 
      SELECT  LEVELID,LEVDETAILS,LEVNAME,CREATEDBY,DATECREATED,STATS
      FROM DRG_SHADOWBILLING.ACR_USER_LEVEL_TBL WHERE STATS='3';
  END IF;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
   -- RETURN ACR_USER_LEVEL;
  END ACR_USER_LEVEL;
  --END USER LEVEL TABLE
  -------------------------------------------------------------------------
    -- USER TABLE
  FUNCTION ACR_USER(tags IN VARCHAR) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
  IF(tags='ACTIVE') THEN
      OPEN v_result FOR 
      SELECT  USERID,LEVELID,USERNAME,USERPASSWORD,DATECREATED,STATS,DID,CREATEDBY
      FROM DRG_SHADOWBILLING.ACR_USER_TBL WHERE STATS='2' OR STATS='1';
  ELSE
      OPEN v_result FOR 
      SELECT  USERID,LEVELID,USERNAME,USERPASSWORD,DATECREATED,STATS,DID,CREATEDBY
      FROM DRG_SHADOWBILLING.ACR_USER_TBL WHERE STATS='3';
  END IF; 
  RETURN v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
    --RETURN ACR_USER;
  END ACR_USER;
  --END USER TABLE


   -------------------------------------------------------------------------
    -- USER TABLE

  -------------------------------------------------------------------------
  FUNCTION ACRUSERNAME(
p_username IN ACR_USER_TBL.USERNAME%TYPE) RETURN SYS_REFCURSOR IS
   p_user SYS_REFCURSOR;
 BEGIN
      OPEN p_user FOR 
      SELECT  USERNAME
      FROM DRG_SHADOWBILLING.ACR_USER_TBL WHERE USERNAME=p_username;
      RETURN p_user;
  END ACRUSERNAME;
  --------------------------------------------------------------------------
  FUNCTION ACRUSERLOGIN(
p_username IN ACR_USER_TBL.USERNAME%TYPE,
p_password IN ACR_USER_TBL.USERPASSWORD%TYPE) RETURN SYS_REFCURSOR IS
   logins SYS_REFCURSOR;
 BEGIN
      OPEN logins FOR 
      SELECT  USERID,LEVELID,USERNAME,USERPASSWORD,DATECREATED,STATS,CREATEDBY
      FROM DRG_SHADOWBILLING.ACR_USER_TBL WHERE USERNAME=p_username AND USERPASSWORD=p_password AND STATS='2';
      RETURN logins;
  END ACRUSERLOGIN;
  --------------------------------------------------------------------------
  FUNCTION ACRUSERLEVEL(p_levelid IN ACR_USER_LEVEL_TBL.LEVELID%TYPE) RETURN SYS_REFCURSOR IS
   v_level SYS_REFCURSOR;
  BEGIN
      OPEN v_level FOR 
      SELECT  LEVDETAILS,LEVNAME
      FROM DRG_SHADOWBILLING.ACR_USER_LEVEL_TBL WHERE LEVELID=p_levelid AND STATS='2';
      RETURN v_level;
  END ACRUSERLEVEL;
  --------------------------------------------------------------------------
  FUNCTION GETTRANCHAMOUNT(p_tranchid IN ACR_TRANCH_TBL.TRANCHID%TYPE) RETURN SYS_REFCURSOR IS
   v_result SYS_REFCURSOR;
BEGIN
      OPEN v_result FOR 
      SELECT  PERCENTAGE
      FROM DRG_SHADOWBILLING.ACR_TRANCH_TBL WHERE TRANCHID=p_tranchid AND STATS='2';
      RETURN v_result;
  END GETTRANCHAMOUNT;
  --------------------------------------------------------------------------
  FUNCTION GETCONTRACTAMOUNT(p_hcfid IN ACR_CONTRACT_TBL.HCFID%TYPE) RETURN SYS_REFCURSOR IS
   v_result SYS_REFCURSOR;
 BEGIN
      OPEN v_result FOR 
      SELECT  AMOUNT
      FROM DRG_SHADOWBILLING.ACR_CONTRACT_TBL WHERE HCFID=p_hcfid AND STATS='2';
      RETURN v_result;
  END GETCONTRACTAMOUNT;
  --------------------------------------------------------------------------
  FUNCTION GETLEVEL(lev_id IN ACR_USER_LEVEL_TBL.LEVELID%TYPE) RETURN SYS_REFCURSOR IS
   v_result SYS_REFCURSOR;
  BEGIN
      OPEN v_result FOR 
      SELECT  LEVNAME
      FROM DRG_SHADOWBILLING.ACR_USER_LEVEL_TBL WHERE LEVELID=lev_id AND STATS='2';
      RETURN v_result;
  END GETLEVEL;
  --------------------------------------------------------------------------
   FUNCTION GETFULLDETAILS(p_userid IN ACR_USER_TBL.USERID%TYPE) RETURN SYS_REFCURSOR IS
   v_result SYS_REFCURSOR;
BEGIN
  OPEN v_result FOR 
  SELECT  
  a.USERID,a.LEVELID,a.USERNAME,a.DID,
  b.FIRSTNAME,b.LASTNAME,b.MIDDLENAME,b.DID AS BDID, b.DATECREATED
  FROM DRG_SHADOWBILLING.ACR_USER_TBL  a 
  JOIN DRG_SHADOWBILLING.ACR_USER_DETAILS_TBL  b
  ON a.DID = b.DID WHERE a.USERID=p_userid;
    RETURN v_result;
  END GETFULLDETAILS;
  --------------------------------------------------------------------------
   FUNCTION GETASSETSBYHCFID(phcfid IN ACR_ASSETS_TBL.HCFID%TYPE,pconid IN ACR_ASSETS_TBL.CONID%TYPE) RETURN SYS_REFCURSOR IS
   v_result SYS_REFCURSOR;
BEGIN
  OPEN v_result FOR 
  SELECT  
  RELEASEDAMOUNT,PREVIOUSBAL,ASSETSID,HCFID,TRANCHID,RECEIPT,AMOUNT,CREATEDBY,DATERELEASED,DATECREATED,CONID
  FROM DRG_SHADOWBILLING.ACR_ASSETS_TBL  WHERE CONID=pconid AND HCFID=phcfid AND STATS='2';
    RETURN v_result;
  END GETASSETSBYHCFID;
  --------------------------------------------------------------------------
   -- USER LOGS TABLE
  FUNCTION ACRACTIVTYLOGS RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
  OPEN v_result FOR 
  SELECT  ACTID,ACTDATE,ACTDETAILS,ACTBY
  FROM DRG_SHADOWBILLING.ACR_USER_ACTIVITY ORDER BY ACTDATE ASC;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
    --RETURN ACRACTIVTYLOGS;
  END ACRACTIVTYLOGS;
  --END USER LOGS TABLE
  -------------------------------------------------------------------------
 -- USER LOGS TABLE
  FUNCTION GETLOGSWITHID(p_userid IN ACR_USER_ACTIVITY.ACTBY%TYPE) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
  OPEN v_result FOR 
  SELECT  ACTID,ACTDATE,ACTDETAILS,ACTBY
  FROM DRG_SHADOWBILLING.ACR_USER_ACTIVITY WHERE ACTBY=p_userid;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETLOGSWITHID;
  --END USER LOGS TABLE
  -------------------------------------------------------------------------

  -- USER LOGS TABLE
  FUNCTION GETSUMMARY(phcfid IN ACR_ASSETS_TBL.HCFID%TYPE) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
  OPEN v_result FOR 
  SELECT COUNT(HCFID) AS cCOUNT,SUM(AMOUNT) AS cTOTAL, HCFID FROM DRG_SHADOWBILLING.ACR_ASSETS_TBL
  WHERE HCFID=phcfid AND STATS='2' GROUP BY HCFID;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETSUMMARY;
  --END USER LOGS TABLE
  -------------------------------------------------------------------------

  -- USER LOGS TABLE
  FUNCTION GETUSERROLEINDEX(puserid IN ACR_ROLE_INDEX_TBL.USERID%TYPE) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN

  IF(puserid=0) THEN
      OPEN v_result FOR 
      SELECT ROLEID,USERID,ACCESSID,CREATEDBY,DATECREATED,STATUS FROM ACR_ROLE_INDEX_TBL
      WHERE STATUS='2';
  ELSE 
      OPEN v_result FOR 
      SELECT ROLEID,USERID,ACCESSID,CREATEDBY,DATECREATED,STATUS FROM ACR_ROLE_INDEX_TBL
      WHERE USERID=puserid AND STATUS='3';
  END IF;
  return v_result;

    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETUSERROLEINDEX;
  --END USER LOGS TABLE
  -------------------------------------------------------------------------


  -- GET MANAGING BOARD REQUEST
  FUNCTION GETMBREQUEST(prequestor IN ACR_MBREQUEST_TBL.REQUESTOR%TYPE) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
      OPEN v_result FOR 
      SELECT MBRID,DATEREQUEST,DATEFROM,DATETO,REQUESTOR,TRANSCODE,REMARKS,STATUS,AMOUNT,DATECREATED 
      FROM ACR_MBREQUEST_TBL WHERE REQUESTOR=prequestor;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETMBREQUEST;
  --END USER LOGS TABLE

  -------------------------------------------------------------------------
  -- GET MANAGING BOARD REQUEST
  FUNCTION GETROLEWITHID(utags IN VARCHAR2,pid IN  ACR_ROLE_INDEX_TBL.USERID%TYPE)RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
    IF(utags='ACTIVE') THEN
       OPEN v_result FOR 
       SELECT ROLEID,USERID,ACCESSID,CREATEDBY,DATECREATED,STATUS FROM ACR_ROLE_INDEX_TBL WHERE USERID=pid AND STATUS='2';
     ELSE 
       OPEN v_result FOR 
       SELECT ROLEID,USERID,ACCESSID,CREATEDBY,DATECREATED,STATUS FROM ACR_ROLE_INDEX_TBL WHERE USERID=pid AND STATUS='3';
     END IF;
      
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETROLEWITHID;
  --END USER LOGS TABLE
  -------------------------------------------------------------------------

   -- GET MANAGING BOARD REQUEST
  FUNCTION GETROLEWITHIDREVERSE(utags IN VARCHAR2,pid IN  ACR_ROLE_INDEX_TBL.ACCESSID%TYPE)RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
      IF(utags='ACTIVE') THEN
         OPEN v_result FOR 
         SELECT ROLEID,USERID,ACCESSID,CREATEDBY,DATECREATED,STATUS FROM ACR_ROLE_INDEX_TBL WHERE ACCESSID=pid AND STATUS='2';
      ELSE
         OPEN v_result FOR 
         SELECT ROLEID,USERID,ACCESSID,CREATEDBY,DATECREATED,STATUS FROM ACR_ROLE_INDEX_TBL WHERE ACCESSID=pid AND STATUS='3';
      END IF;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETROLEWITHIDREVERSE;
  --END USER LOGS TABLE
  -------------------------------------------------------------------------
   -- GET PRO USING MBID

  --END USER LOGS TABLE
  -------------------------------------------------------------------------
  -- GET MANAGING BOARD REQUEST
  FUNCTION GETROLETWOPARAM(utags IN VARCHAR2,puserid IN DRG_SHADOWBILLING.ACR_ROLE_INDEX_TBL.USERID%TYPE,
paccessid IN ACR_ROLE_INDEX_TBL.ACCESSID%TYPE)RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
    IF(utags='ACTIVE') THEN 
              OPEN v_result FOR 
              SELECT ROLEID,USERID,ACCESSID,CREATEDBY,DATECREATED,STATUS 
              FROM ACR_ROLE_INDEX_TBL WHERE USERID=puserid AND ACCESSID=paccessid AND STATUS='2';
      ELSE
           OPEN v_result FOR 
              SELECT ROLEID,USERID,ACCESSID,CREATEDBY,DATECREATED,STATUS 
              FROM ACR_ROLE_INDEX_TBL WHERE USERID=puserid AND ACCESSID=paccessid AND STATUS='3';
      
      END IF;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETROLETWOPARAM;
  --END USER LOGS TABLE
-------------------------------------------------------------------------

  -- HEALTH CARE FACILITY TABLE

  --END HEALTH CARE FACILITY TABLE
-------------------------------------------------------------------------
  --  CONTRACT TABLE
  FUNCTION GETCONTRACTCONID(pconid IN ACR_CONTRACT_TBL.CONID%TYPE,utags IN VARCHAR2) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
        IF(utags='ACTIVE') THEN
                      OPEN v_result FOR 
                      SELECT  QUARTER,SB,ADDAMOUNT,C_CLAIMSVOL,T_CLAIMSVOL,CONID,HCFID,AMOUNT,STATS,CREATEDBY,DATECREATED,CONTRACTDATE,TRANSCODE,BASEAMOUNT
                      FROM DRG_SHADOWBILLING.ACR_CONTRACT_TBL WHERE CONID=pconid AND STATS='2';
         ELSE
                      OPEN v_result FOR 
                      SELECT   QUARTER,SB,ADDAMOUNT,C_CLAIMSVOL,T_CLAIMSVOL,CONID,HCFID,AMOUNT,STATS,CREATEDBY,DATECREATED,CONTRACTDATE,TRANSCODE,BASEAMOUNT
                      FROM DRG_SHADOWBILLING.ACR_CONTRACT_TBL WHERE CONID=pconid AND STATS='3';
         
         END IF;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
    --RETURN ACR_CONTRACT;
  END GETCONTRACTCONID;
  --END  GETCONTRACTCONID
-------------------------------------------------------------------------
   FUNCTION GETTOTALRELEASEUNDERMB(tags IN VARCHAR,pconid IN ACR_ASSETS_TBL.CONID%TYPE) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
IF(tags='ACTIVE') THEN
     OPEN v_result FOR 
          SELECT  SUM(AMOUNT)AS CAMOUNT, COUNT(CONID) AS TCONID
          FROM DRG_SHADOWBILLING.ACR_ASSETS_TBL WHERE CONID=pconid AND STATS='2';
  ELSE
      OPEN v_result FOR 
      SELECT  SUM(AMOUNT)AS CAMOUNT, COUNT(CONID) AS TCONID
          FROM DRG_SHADOWBILLING.ACR_ASSETS_TBL WHERE CONID=pconid AND STATS='3';
  END IF;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
    --RETURN ACR_CONTRACT;
  END GETTOTALRELEASEUNDERMB;
  --END  GETTOTALRELEASEUNDERMB
  -------------------------------------------------------------------------
  FUNCTION GETTERMINATECON(pan IN DRG_SHADOWBILLING.ACR_CONTRACT_TBL.HCFID%TYPE) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
     OPEN v_result FOR 
          SELECT  CONID,HCFID,AMOUNT,STATS,CREATEDBY,
          DATECREATED,CONTRACTDATE,
          TRANSCODE,BASEAMOUNT,REMARKS,ENDDATE
          FROM DRG_SHADOWBILLING.ACR_CONTRACT_TBL WHERE HCFID=pan AND ENDDATE IS NOT NULL AND STATS='2';
  return v_result;
  END GETTERMINATECON;
  --END  GET TERMINATED CONTRACT
  -------------------------------------------------------------------------
  FUNCTION GETACCREDITATION(uaccreno IN ACR_ACCREDITATION.ACCRENO%TYPE) RETURN SYS_REFCURSOR IS
   v_result SYS_REFCURSOR;
BEGIN
    OPEN v_result FOR 
            SELECT  
            ACCRENO,DATEFROM,DATETO,DATECREATED,CREATEDBY,STATUS
            FROM DRG_SHADOWBILLING.ACR_ACCREDITATION  WHERE ACCRENO=uaccreno;
    RETURN v_result;
  END GETACCREDITATION;
  -------------------------------------------------------------------------
FUNCTION GETCONBYCODE(ucode IN DRG_SHADOWBILLING.ACR_CONTRACT_TBL.HCFID%TYPE) RETURN SYS_REFCURSOR IS
   v_result SYS_REFCURSOR;
BEGIN
    OPEN v_result FOR 
            SELECT  
            QUARTER,SB,ADDAMOUNT,T_CLAIMSVOL,C_CLAIMSVOL,CONID,HCFID,AMOUNT,STATS,CREATEDBY,DATECREATED,CONTRACTDATE,TRANSCODE,BASEAMOUNT,REMARKS,ENDDATE
            FROM DRG_SHADOWBILLING.ACR_CONTRACT_TBL  WHERE HCFID=ucode AND STATS='2';
    RETURN v_result;
  END GETCONBYCODE;
  -------------------------------------------------------------------------
FUNCTION GETAPPELLATE(tags IN VARCHAR2,ucontrolcode IN DRG_SHADOWBILLING.ACR_APPELLATE.CONTROLCODE%TYPE) RETURN SYS_REFCURSOR IS
   v_result SYS_REFCURSOR;
BEGIN
        IF(tags='ACTIVE') THEN
            OPEN v_result FOR 
            SELECT ID,ACCESSCODE,CONTROLCODE
            FROM DRG_SHADOWBILLING.ACR_APPELLATE WHERE CONTROLCODE=ucontrolcode AND STATUS='2';
        ELSE
            OPEN v_result FOR 
            SELECT ID,ACCESSCODE,CONTROLCODE
            FROM DRG_SHADOWBILLING.ACR_APPELLATE WHERE CONTROLCODE=ucontrolcode AND STATUS='3';    
        END IF;
    RETURN v_result;
  END GETAPPELLATE;
  -------------------------------------------------------------------------
  FUNCTION GETASSETSBYCONID(pconid IN ACR_ASSETS_TBL.CONID%TYPE) RETURN SYS_REFCURSOR IS
   v_result SYS_REFCURSOR;
BEGIN
    OPEN v_result FOR 
            SELECT  
            RELEASEDAMOUNT,PREVIOUSBAL,ASSETSID,HCFID,TRANCHID,RECEIPT,AMOUNT,CREATEDBY,DATERELEASED,DATECREATED,CONID,STATS
            FROM DRG_SHADOWBILLING.ACR_ASSETS_TBL  WHERE CONID=pconid ORDER BY DATERELEASED ASC;
    RETURN v_result;
  END GETASSETSBYCONID;
   -------------------------------------------------------------------------
   FUNCTION GETASSETSBYHCF(phcfid IN ACR_ASSETS_TBL.HCFID%TYPE,
                         pdatefrom IN DATE,
                         pdateto IN DATE) RETURN SYS_REFCURSOR IS
   v_result SYS_REFCURSOR;
BEGIN
    OPEN v_result FOR 
            SELECT  
            RELEASEDAMOUNT,PREVIOUSBAL,ASSETSID,HCFID,TRANCHID,RECEIPT,AMOUNT,CREATEDBY,DATERELEASED,DATECREATED,CONID,STATS
            FROM DRG_SHADOWBILLING.ACR_ASSETS_TBL  WHERE HCFID=phcfid AND STATS='2'
            AND TO_DATE(DATERELEASED,'MM-DD-YYYY') BETWEEN TO_DATE(pdatefrom,'MM-DD-YYYY') AND TO_DATE(pdateto,'MM-DD-YYYY');
    RETURN v_result;
  END GETASSETSBYHCF;
   -------------------------------------------------------------------------  
  FUNCTION GETASSETBYIDANDCONID(phcfid IN ACR_ASSETS_TBL.HCFID%TYPE,
                               uconid IN ACR_ASSETS_TBL.CONID%TYPE,
                               utags IN VARCHAR2) RETURN SYS_REFCURSOR IS
   v_result SYS_REFCURSOR;
BEGIN


            IF(utags='ACTIVE') THEN
                    OPEN v_result FOR 
                    SELECT  
                    RELEASEDAMOUNT,PREVIOUSBAL,ASSETSID,HCFID,TRANCHID,RECEIPT,AMOUNT,CREATEDBY,DATERELEASED,DATECREATED,CONID,STATS
                    FROM DRG_SHADOWBILLING.ACR_ASSETS_TBL  WHERE HCFID=phcfid AND CONID=uconid AND STATS='2';
            ELSE
                    OPEN v_result FOR 
                    SELECT  
                    RELEASEDAMOUNT,PREVIOUSBAL,ASSETSID,HCFID,TRANCHID,RECEIPT,AMOUNT,CREATEDBY,DATERELEASED,DATECREATED,CONID,STATS
                    FROM DRG_SHADOWBILLING.ACR_ASSETS_TBL  WHERE HCFID=phcfid AND CONID=uconid AND STATS='3';
            END IF;
    RETURN v_result;
  END GETASSETBYIDANDCONID;
    -------------------------------------------------------------------------  
FUNCTION GETASSETSHCFID(phcfid IN ACR_ASSETS_TBL.HCFID%TYPE) RETURN SYS_REFCURSOR IS
   v_result SYS_REFCURSOR;
BEGIN
              OPEN v_result FOR 
              SELECT  
              RELEASEDAMOUNT,PREVIOUSBAL,ASSETSID,HCFID,TRANCHID,RECEIPT,AMOUNT,CREATEDBY,DATERELEASED,DATECREATED,CONID,STATS
              FROM DRG_SHADOWBILLING.ACR_ASSETS_TBL  WHERE HCFID=phcfid ORDER BY DATERELEASED ASC;

    RETURN v_result;
  END GETASSETSHCFID;
    -------------------------------------------------------------------------  
FUNCTION GETMB(tags IN VARCHAR2) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
     IF(tags='PENDING') THEN
          OPEN v_result FOR 
          SELECT MBID,MBNAME,DATECREATED,CREATEDBY,STATUS,CONNUMBER,ADDRESS,BANKACCOUNT,BANKNAME,REMARKS FROM ACR_MB_TBL WHERE STATUS='1';
      ELSIF(tags='ACTIVE') THEN
         OPEN v_result FOR 
         SELECT MBID,MBNAME,DATECREATED,CREATEDBY,STATUS,CONNUMBER,ADDRESS,BANKACCOUNT,BANKNAME,REMARKS FROM ACR_MB_TBL WHERE STATUS='2';
      ELSIF(tags='REJECT') THEN
          OPEN v_result FOR 
         SELECT MBID,MBNAME,DATECREATED,CREATEDBY,STATUS,CONNUMBER,ADDRESS,BANKACCOUNT,BANKNAME,REMARKS FROM ACR_MB_TBL WHERE STATUS='4';
         ELSE
          OPEN v_result FOR 
         SELECT MBID,MBNAME,DATECREATED,CREATEDBY,STATUS,CONNUMBER,ADDRESS,BANKACCOUNT,BANKNAME,REMARKS FROM ACR_MB_TBL WHERE STATUS='3';
      END IF;

  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETMB;
  -------------------------------------------------------------------------------------------------------------
FUNCTION GETMBWITHID(pid IN  DRG_SHADOWBILLING.ACR_MB_TBL.CONNUMBER%TYPE)RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
      OPEN v_result FOR 
      SELECT MBID,MBNAME,DATECREATED,CREATEDBY,STATUS,CONNUMBER,ADDRESS,BANKACCOUNT,BANKNAME FROM DRG_SHADOWBILLING.ACR_MB_TBL WHERE CONNUMBER=pid AND STATUS='2';
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETMBWITHID;
 -------------------------------------------------------------------------
FUNCTION GETCONDATE(tags IN VARCHAR2) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
    IF(tags='ACTIVE') THEN
       OPEN v_result FOR 
       SELECT CONDATEID,STATUS,DATEFROM,DATETO,CREATEDBY,DATECREATED FROM DRG_SHADOWBILLING.ACR_CONTRACT_DATE_TBL WHERE STATUS='2';
    ELSE
       OPEN v_result FOR 
        SELECT CONDATEID,STATUS,DATEFROM,DATETO,CREATEDBY,DATECREATED FROM DRG_SHADOWBILLING.ACR_CONTRACT_DATE_TBL WHERE STATUS='3';
    END IF;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETCONDATE;
 -------------------------------------------------------------------------
 FUNCTION GETCONDATEBYID(ucondateid IN ACR_CONTRACT_DATE_TBL.CONDATEID%TYPE) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN

       OPEN v_result FOR 
       SELECT CONDATEID,STATUS,DATEFROM,DATETO,CREATEDBY,DATECREATED FROM DRG_SHADOWBILLING.ACR_CONTRACT_DATE_TBL 
       WHERE CONDATEID=ucondateid;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETCONDATEBYID;
 -------------------------------------------------------------------------
  FUNCTION GETUSERBYID(uUserid IN ACR_USER_TBL.USERID%TYPE) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
       OPEN v_result FOR 
      SELECT  
              a.LEVELID,b.LEVNAME
              FROM DRG_SHADOWBILLING.ACR_USER_TBL  a 
              JOIN DRG_SHADOWBILLING.ACR_USER_LEVEL_TBL  b
              ON a.LEVELID = b.LEVELID WHERE a.USERID=uUserid;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETUSERBYID;
 -------------------------------------------------------------------------
 FUNCTION GETCONTRACTBYCONDATEID(ucondateid IN ACR_CONTRACT_TBL.CONTRACTDATE%TYPE) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
       OPEN v_result FOR 
       SELECT  QUARTER,SB,ADDAMOUNT,C_CLAIMSVOL,T_CLAIMSVOL,CONID,HCFID,AMOUNT,STATS,CREATEDBY,DATECREATED,CONTRACTDATE,TRANSCODE,BASEAMOUNT,REMARKS,ENDDATE FROM DRG_SHADOWBILLING.ACR_CONTRACT_TBL 
       WHERE CONTRACTDATE=ucondateid;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETCONTRACTBYCONDATEID;
  -------------------------------------------------------------------------
  FUNCTION GETPREVIOUSBALANCE(paccount IN ACR_CON_BALANCE.ACCOUNT%TYPE,
                                pconid IN ACR_CON_BALANCE.CONID%TYPE) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
   IF(pconid=0) THEN 
      OPEN v_result FOR 
      SELECT BOOKNUM,CONDATEID,ACCOUNT,CONBALANCE,CONAMOUNT,CONUTILIZED,DATECREATED,STATUS,CONID 
      FROM DRG_SHADOWBILLING.ACR_CON_BALANCE WHERE ACCOUNT=paccount AND STATUS='2';
    ELSE
      OPEN v_result FOR 
      SELECT BOOKNUM,CONDATEID,ACCOUNT,CONBALANCE,CONAMOUNT,CONUTILIZED,DATECREATED,STATUS,CONID 
      FROM DRG_SHADOWBILLING.ACR_CON_BALANCE WHERE ACCOUNT=paccount AND CONID=pconid  AND STATUS='3';
    END IF;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETPREVIOUSBALANCE;
  -------------------------------------------------------------------------
FUNCTION GETEMAILCRED RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
       OPEN v_result FOR 
      SELECT SENDER,APPUSER,APPPASS FROM DRG_SHADOWBILLING.ACR_EMAIL_CRED_TBL;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETEMAILCRED;
  -------------------------------------------------------------------------
  FUNCTION GETSUMAMOUNTCLAIMSBOOKDATA(
 ulevel IN VARCHAR,
  uaccreno IN ACR_BOOK_DATA.PMCC_NO%TYPE,
  utags IN ACR_BOOK_DATA.TAGS%TYPE,
  udatefrom IN OUT ACR_BOOK_DATA.DATESUBMITTED%TYPE,
  udateto IN OUT ACR_BOOK_DATA.DATESUBMITTED%TYPE) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
    IF(ulevel='TWO') THEN
          OPEN v_result FOR 
          SELECT  SUM(CLAIMAMOUNT) AS CTOTAL,PMCC_NO,COUNT(CLAIMAMOUNT) AS COUNTVAL,
          TRUNC(DATESUBMITTED) AS DATESUB
          FROM DRG_SHADOWBILLING.ACR_BOOK_DATA 
          WHERE PMCC_NO=uaccreno AND TAGS=utags 
          AND 
          (TO_DATE(TRUNC(DATE_ADM),'DD-MON-YY')>=TO_DATE(udatefrom,'DD-MON-YY') AND 
          TO_DATE(TRUNC(DATESUBMITTED),'DD-MON-YY')<=TO_DATE(udateto,'DD-MON-YY')) 
          GROUP BY PMCC_NO,TRUNC(DATESUBMITTED) ORDER BY TRUNC(DATESUBMITTED) ASC;
            -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
    ELSE
    OPEN v_result FOR 
           SELECT  SUM(CLAIMAMOUNT) AS CTOTAL,PMCC_NO,COUNT(CLAIMAMOUNT) AS COUNTVAL,
          TRUNC(DATESUBMITTED) AS DATESUB
          FROM DRG_SHADOWBILLING.ACR_BOOK_DATA WHERE PMCC_NO=uaccreno AND TAGS=utags AND 
          TO_DATE(udatefrom,'DD-MON-YY') BETWEEN TO_DATE(TRUNC(DATE_ADM),'DD-MON-YY') 
          AND TO_DATE(TRUNC(DATESUBMITTED),'DD-MON-YY') 
          GROUP BY PMCC_NO,TRUNC(DATESUBMITTED) ORDER BY TRUNC(DATESUBMITTED) ASC; 
    END IF;
    RETURN v_result;
  END GETSUMAMOUNTCLAIMSBOOKDATA;
   -------------------------------------------------------------------------
   
FUNCTION GETROLEWITHIDFORENDROLE(utags IN VARCHAR2,
pid IN  ACR_ROLE_INDEX_TBL.USERID%TYPE,
pcondateid IN ACR_ROLE_INDEX_TBL.CONDATE%TYPE)RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
    IF(utags='ACTIVE') THEN
       OPEN v_result FOR 
       SELECT ROLEID,USERID,ACCESSID,CREATEDBY,DATECREATED,STATUS,CONDATE FROM ACR_ROLE_INDEX_TBL WHERE CONDATE=pcondateid AND USERID=pid AND STATUS='2';
     ELSE 
       OPEN v_result FOR 
       SELECT ROLEID,USERID,ACCESSID,CREATEDBY,DATECREATED,STATUS,CONDATE FROM ACR_ROLE_INDEX_TBL WHERE CONDATE=pcondateid AND USERID=pid AND STATUS='3';
     END IF;
      
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETROLEWITHIDFORENDROLE;
  --END USER LOGS TABLE
  -------------------------------------------------------------------------
  FUNCTION GETUSERINFOUSINGEMAIL(uemailadd IN ACR_USER_DETAILS_TBL.EMAIL%TYPE)RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
       OPEN v_result FOR 
       SELECT DID,FIRSTNAME,LASTNAME,MIDDLENAME,DATECREATED,STATS,CREATEDBY,EMAIL,CONTACT 
       FROM ACR_USER_DETAILS_TBL WHERE EMAIL=uemailadd AND STATS='2';   
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETUSERINFOUSINGEMAIL;
  --END USER LOGS TABLE
  -------------------------------------------------------------------------
  FUNCTION GETACCOUNTUSINGEMAIL(uusername IN ACR_USER_TBL.USERNAME%TYPE)RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
       OPEN v_result FOR 
       SELECT USERID,LEVELID,USERNAME,USERPASSWORD,DATECREATED,STATS,CREATEDBY,DID 
       FROM ACR_USER_TBL WHERE USERNAME=uusername AND STATS='2';   
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETACCOUNTUSINGEMAIL;
  --END USER LOGS TABLE
  -------------------------------------------------------------------------
   FUNCTION FORUSERLEVEL(ulevelid IN ACR_USER_LEVEL_TBL.LEVELID%TYPE)RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
           OPEN v_result FOR 
           SELECT LEVELID,LEVDETAILS,LEVNAME,CREATEDBY,DATECREATED,STATS 
           FROM ACR_USER_LEVEL_TBL WHERE LEVELID=ulevelid AND STATS='2';   
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END FORUSERLEVEL;
  --END USER LOGS TABLE
  -------------------------------------------------------------------------
   FUNCTION GETPASSUSINGUSERID(puserid IN ACR_USER_TBL.USERID%TYPE)RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
           OPEN v_result FOR 
           SELECT USERID,LEVELID,USERNAME,USERPASSWORD,DATECREATED,STATS,CREATEDBY,DID 
           FROM DRG_SHADOWBILLING.ACR_USER_TBL WHERE USERID=puserid AND STATS='2';   
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETPASSUSINGUSERID;
  ------------------------------------------------------------------------- 
  FUNCTION GETACR_BOOKING RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
           OPEN v_result FOR 
           SELECT BOOKNUM,CONID,DATECREATED,CREATEDBY
           FROM DRG_SHADOWBILLING.ACR_BOOKING ORDER BY DATECREATED ASC;   
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETACR_BOOKING;
  ------------------------------------------------------------------------- 
  FUNCTION GETALLCONTRACT(utags IN VARCHAR2) RETURN SYS_REFCURSOR 
IS
 v_result SYS_REFCURSOR;
BEGIN
IF(utags='ACTIVE') THEN
           OPEN v_result FOR 
           SELECT CONID,HCFID,AMOUNT,STATS,CREATEDBY,DATECREATED,TRANSCODE,BASEAMOUNT,REMARKS,ENDDATE,CONTRACTDATE,C_CLAIMSVOL,T_CLAIMSVOL,SB,ADDAMOUNT,QUARTER
           FROM DRG_SHADOWBILLING.ACR_CONTRACT_TBL WHERE STATS ='2'  ORDER BY  DATECREATED ASC;   
ELSE
            OPEN v_result FOR 
           SELECT CONID,HCFID,AMOUNT,STATS,CREATEDBY,DATECREATED,TRANSCODE,BASEAMOUNT,REMARKS,ENDDATE,CONTRACTDATE,C_CLAIMSVOL,T_CLAIMSVOL,SB,ADDAMOUNT,QUARTER
           FROM DRG_SHADOWBILLING.ACR_CONTRACT_TBL WHERE STATS ='3'  ORDER BY DATECREATED ASC;   


END IF;
  return v_result;
    -- TODO: Implementation required for FUNCTION ACRGBPACKAGE.ACR_ACCOUNTS_PAYABLE_TBL
  END GETALLCONTRACT;
  ------------------------------------------------------------------------- 
  
  

END ACRGBPKGFUNCTION;